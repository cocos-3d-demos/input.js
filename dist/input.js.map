{"version":3,"file":"input.js","sources":["../index.js"],"sourcesContent":["const KEY_NONE = 0;\nconst KEY_DOWN = 1;\nconst KEY_PRESSING = 2;\nconst KEY_UP = 3;\n\nlet _dragMask = null;\n\nexport default class Input {\n  /**\n   * @method constructor\n   * @param {HTMLElement} [element]\n   * @param {object} [opts]\n   * @param {boolean} [opts.lock] - lock cursor when mouse down. default is false.\n   * @param {boolean} [opts.useMask] - use drag mask (for prevent cursor changes).\n   * @param {string} [opts.maskCursor] - the cursor for drag mask.\n   */\n  constructor (element, opts) {\n    opts = opts || {};\n\n    if (!_dragMask && opts.useMask) {\n      _dragMask = document.createElement('div');\n      _dragMask.classList.add('drag-mask');\n      _dragMask.style.position = 'fixed';\n      _dragMask.style.zIndex = '9999';\n      _dragMask.style.top = '0';\n      _dragMask.style.right = '0';\n      _dragMask.style.bottom = '0';\n      _dragMask.style.left = '0';\n      _dragMask.oncontextmenu = function () { return false; };\n    }\n\n    this._opts = opts;\n    this._element = element || document.body;\n    this._lastTime = 0;\n    this._globalEventInstalled = false;\n\n    // mouse internal states\n    this._pointerLocked = false;\n    this._mouseGrabbed = false;\n\n    this._bcr = element.getBoundingClientRect();\n\n    // the mouse state\n    this._mouse = {\n      x: 0,\n      y: 0,\n      dx: 0,\n      dy: 0,\n      prevX: 0,\n      prevY: 0,\n\n      // mouse wheel (delta)\n      scrollX: 0,\n      scrollY: 0,\n\n      // buttons\n      left: KEY_NONE,\n      right: KEY_NONE,\n      middle: KEY_NONE,\n    };\n\n    // the keyboard state\n    this._keyboard = {\n      // key-name: key-state (0: none, 1: down, 2: press, 3: up)\n    };\n\n    // mousemove\n    this._mousemoveHandle = event => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      this._mouse.dx = event.movementX;\n      this._mouse.dy = event.movementY;\n\n      if (this._pointerLocked) {\n        this._mouse.x += event.movementX;\n        this._mouse.y += event.movementY;\n      } else {\n        this._mouse.x = event.clientX - this._bcr.left;\n        this._mouse.y = event.clientY - this._bcr.top;\n      }\n    };\n\n    // mousewheel\n    this._mousewheelHandle = event => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      this._mouse.scrollX = event.deltaX;\n      this._mouse.scrollY = event.deltaY;\n    };\n\n    // mousedown\n    this._mousedownHandle = event => {\n      // NOTE: this will prevent mouse enter the text selection state.\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (this._opts.lock) {\n        this._lock(true);\n      }\n\n      this._installGlobalEvents();\n      this._element.focus();\n\n      // handle mouse button\n      switch (event.button) {\n        // left mouse down\n        case 0:\n          // NOTE: do not reset KEY_DOWN when it already pressed\n          if (this._mouse.left !== KEY_PRESSING) {\n            this._mouse.left = KEY_DOWN;\n          }\n          break;\n\n        // middle mouse down\n        case 1:\n          // NOTE: do not reset KEY_DOWN when it already pressed\n          if (this._mouse.middle !== KEY_PRESSING) {\n            this._mouse.middle = KEY_DOWN;\n          }\n          break;\n\n        // right mouse down\n        case 2:\n          // NOTE: do not reset KEY_DOWN when it already pressed\n          if (this._mouse.right !== KEY_PRESSING) {\n            this._mouse.right = KEY_DOWN;\n          }\n          break;\n      }\n    };\n\n    // mouseup\n    this._mouseupHandle = event => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      // reset mouse position\n      this._mouse.dx = event.movementX;\n      this._mouse.dy = event.movementY;\n      this._mouse.prevX = this._mouse.x = event.clientX - this._bcr.left;\n      this._mouse.prevX = this._mouse.y = event.clientY - this._bcr.top;\n\n      // handle mouse button\n      switch (event.button) {\n        // left mouse down\n        case 0:\n          this._mouse.left = KEY_UP;\n          break;\n\n        // middle mouse down\n        case 1:\n          this._mouse.middle = KEY_UP;\n          break;\n\n        // right mouse down\n        case 2:\n          this._mouse.right = KEY_UP;\n          break;\n      }\n    };\n\n    // mouseenter\n    this._mouseenterHandle = event => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      this._mouse.dx = 0.0;\n      this._mouse.dy = 0.0;\n      this._mouse.prevX = this._mouse.x = event.clientX - this._bcr.left;\n      this._mouse.prevX = this._mouse.y = event.clientY - this._bcr.top;\n    };\n\n    // mouseleave\n    this._mouseleaveHandle = event => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (this._mouseGrabbed) {\n        return;\n      }\n\n      this._uninstallGlobalEvents();\n\n      this._mouse.dx = event.movementX;\n      this._mouse.dy = event.movementY;\n      this._mouse.prevX = this._mouse.x = event.clientX - this._bcr.left;\n      this._mouse.prevX = this._mouse.y = event.clientY - this._bcr.top;\n    };\n\n    // keydown\n    this._keydownHandle = event => {\n      event.stopPropagation();\n\n      // NOTE: do not reset KEY_DOWN when it already pressed\n      if ( this._keyboard[event.key] !== KEY_PRESSING ) {\n        this._keyboard[event.key] = KEY_DOWN;\n      }\n    };\n\n    // keyup\n    this._keyupHandle = event => {\n      event.stopPropagation();\n\n      this._keyboard[event.key] = KEY_UP;\n    };\n\n    // contextmenu\n    this._contextmenuHandle = event => {\n      event.preventDefault();\n      event.stopPropagation();\n    };\n\n    this._registerEvents();\n  }\n\n  destroy () {\n    this._element.removeEventListener('mousedown', this._mousedownHandle);\n    this._element.removeEventListener('mouseenter', this._mouseenterHandle);\n    this._element.removeEventListener('mouseleave', this._mouseleaveHandle);\n    this._element.removeEventListener('mousemove', this._mousemoveHandle);\n    this._element.removeEventListener('mousewheel', this._mousewheelHandle);\n    this._element.removeEventListener('keydown', this._keydownHandle);\n    this._element.removeEventListener('keyup', this._keyupHandle);\n\n    this._element.removeEventListener('contextmenu', this._contextmenuHandle);\n\n    this._uninstallGlobalEvents();\n  }\n\n  _registerEvents () {\n    this._element.addEventListener('mousedown', this._mousedownHandle);\n    this._element.addEventListener('mouseenter', this._mouseenterHandle);\n    this._element.addEventListener('mouseleave', this._mouseleaveHandle);\n    this._element.addEventListener('mousemove', this._mousemoveHandle);\n    this._element.addEventListener('mousewheel', this._mousewheelHandle);\n    this._element.addEventListener('keydown', this._keydownHandle);\n    this._element.addEventListener('keyup', this._keyupHandle);\n\n    this._element.addEventListener('contextmenu', this._contextmenuHandle);\n  }\n\n  _installGlobalEvents () {\n    if (this._globalEventInstalled) {\n      return;\n    }\n\n    document.addEventListener('mouseup', this._mouseupHandle);\n    document.addEventListener('mousemove', this._mousemoveHandle);\n    document.addEventListener('mousewheel', this._mousewheelHandle, {passive: true});\n\n    if (this._opts.useMask) {\n      _dragMask.style.cursor = this._opts.maskCursor || 'default';\n      document.body.appendChild(_dragMask);\n    }\n\n    this._globalEventInstalled = true;\n  }\n\n  _uninstallGlobalEvents () {\n    if (!this._globalEventInstalled) {\n      return;\n    }\n\n    // if we have mouse key pressed, skip it\n    if (\n      (this._mouse.left !== KEY_NONE && this._mouse.left !== KEY_UP) ||\n      (this._mouse.right !== KEY_NONE && this._mouse.right !== KEY_UP) ||\n      (this._mouse.middle !== KEY_NONE && this._mouse.middle !== KEY_UP)\n    ) {\n      return;\n    }\n\n    // unlock mouse here\n    this._lock(false);\n\n    // if we are grabbing mouse, skip it\n    if (this._mouseGrabbed) {\n      return;\n    }\n\n    document.removeEventListener('mouseup', this._mouseupHandle);\n    document.removeEventListener('mousemove', this._mousemoveHandle);\n    document.removeEventListener('mousewheel', this._mousewheelHandle, { passive: true });\n\n    if (this._opts.useMask) {\n      _dragMask.remove();\n    }\n\n    this._globalEventInstalled = false;\n  }\n\n  // NOTE: in web-browser, requestPointerLock only works in mousedown event\n  _lock (locked) {\n    if (locked) {\n      if (this._pointerLocked) {\n        return;\n      }\n\n      if (this._element.requestPointerLock) {\n        this._element.requestPointerLock();\n        this._pointerLocked = true;\n      }\n\n      return;\n    } else {\n      if (!this._pointerLocked) {\n        return;\n      }\n\n      if (document.exitPointerLock) {\n        document.exitPointerLock();\n        this._pointerLocked = false;\n      }\n    }\n  }\n\n  /**\n   * @property {number} mouseX\n   */\n  get mouseX () {\n    return this._mouse.x;\n  }\n\n  /**\n   * @property {number} mouseY\n   */\n  get mouseY () {\n    return this._mouse.y;\n  }\n\n  /**\n   * @property {number} mouseDeltaX\n   */\n  get mouseDeltaX () {\n    return this._mouse.dx;\n  }\n\n  /**\n   * @property {number} mouseDeltaY\n   */\n  get mouseDeltaY () {\n    return this._mouse.dy;\n  }\n\n  /**\n   * @property {number} mouseScrollX\n   */\n  get mouseScrollX () {\n    return this._mouse.scrollX;\n  }\n\n  /**\n   * @property {number} mouseScrollY\n   */\n  get mouseScrollY () {\n    return this._mouse.scrollY;\n  }\n\n  /**\n   * @method reset\n   *\n   * Reset the input states.\n   * NOTE: you should call this at the end of your frame.\n   */\n  reset () {\n    // update mouse states\n    this._mouse.prevX = this._mouse.x;\n    this._mouse.prevY = this._mouse.y;\n\n    this._mouse.dx = 0;\n    this._mouse.dy = 0;\n\n    this._mouse.scrollX = 0;\n    this._mouse.scrollY = 0;\n\n    if (this._mouse.left === KEY_DOWN) {\n      this._mouse.left = KEY_PRESSING;\n    } else if (this._mouse.left === KEY_UP) {\n      this._mouse.left = KEY_NONE;\n    }\n\n    if (this._mouse.middle === KEY_DOWN) {\n      this._mouse.middle = KEY_PRESSING;\n    } else if (this._mouse.middle === KEY_UP) {\n      this._mouse.middle = KEY_NONE;\n    }\n\n    if (this._mouse.right === KEY_DOWN) {\n      this._mouse.right = KEY_PRESSING;\n    } else if (this._mouse.right === KEY_UP) {\n      this._mouse.right = KEY_NONE;\n    }\n\n    // update keyboard states\n    for (let name in this._keyboard) {\n      let state = this._keyboard[name];\n      if ( state === KEY_DOWN ) {\n        this._keyboard[name] = KEY_PRESSING;\n      } else if ( state === KEY_UP ) {\n        this._keyboard[name] = KEY_NONE;\n      }\n    }\n\n    // check if uninstall global events\n    this._uninstallGlobalEvents();\n  }\n\n  /**\n   * @method resize\n   *\n   * Update cached bounding client size.\n   */\n  resize () {\n    this._bcr = this._element.getBoundingClientRect();\n  }\n\n  /**\n   * @method grabMouse\n   * @param {boolean} grabbed\n   *\n   * Keep tracing mouse move event when mouse leave the target element.\n   */\n  grabMouse (grabbed) {\n    this._mouseGrabbed = grabbed;\n\n    if (grabbed) {\n      this._installGlobalEvents();\n    } else {\n      this._uninstallGlobalEvents();\n    }\n  }\n\n  /**\n   * @method mousedown\n   * @param {string} name - 'left', 'right' or 'middle'\n   */\n  mousedown (name) {\n    let btn = this._mouse[name];\n    if (btn !== undefined) {\n      return btn === KEY_DOWN;\n    }\n\n    return false;\n  }\n\n  /**\n   * @method mousepress\n   * @param {string} name - 'left', 'right' or 'middle'\n   */\n  mousepress (name) {\n    let btn = this._mouse[name];\n    if (btn !== undefined) {\n      return btn === KEY_DOWN || btn === KEY_PRESSING;\n    }\n\n    return false;\n  }\n\n  /**\n   * @method mouseup\n   * @param {string} name - 'left', 'right' or 'middle'\n   */\n  mouseup (name) {\n    let btn = this._mouse[name];\n    if (btn !== undefined) {\n      return btn === KEY_UP;\n    }\n\n    return false;\n  }\n\n  /**\n   * @method keydown\n   * @param {string} name\n   */\n  keydown (name) {\n    return this._keyboard[name] === KEY_DOWN;\n  }\n\n  /**\n   * @method keyup\n   * @param {string} name\n   */\n  keyup (name) {\n    return this._keyboard[name] === KEY_UP;\n  }\n\n  /**\n   * @method keypress\n   * @param {string} name\n   */\n  keypress (name) {\n    return this._keyboard[name] === KEY_DOWN ||\n      this._keyboard[name] === KEY_PRESSING;\n  }\n}"],"names":["const","let","this"],"mappings":"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"}